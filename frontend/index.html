<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>每日新聞自動摘要系統</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>📰 每日新聞自動摘要系統</h1>
            <p class="subtitle">自動抓取、摘要、寄送新聞到您的信箱</p>
            <button type="button" class="settings-btn" onclick="openSettings()">⚙️ 設定</button>
        </header>

        <main>
            <!-- 搜尋表單 -->
            <section class="form-section">
                <form id="newsForm">
                    <!-- 搜尋模式 -->
                    <div class="form-group">
                        <label>搜尋模式</label>
                        <div class="radio-group">
                            <label class="radio-label">
                                <input type="radio" name="searchMode" value="rss" checked>
                                <span>RSS 模式 (免費無限制)</span>
                            </label>
                            <label class="radio-label">
                                <input type="radio" name="searchMode" value="google" id="googleSearchRadio">
                                <span>Google Search (每日 100 次)</span>
                                <span class="api-status" id="googleApiStatus"></span>
                            </label>
                        </div>
                    </div>

                    <!-- 語言選擇 -->
                    <div class="form-group">
                        <label for="language">語言選擇</label>
                        <select id="language" name="language" required>
                            <option value="zh-TW">中文</option>
                            <option value="en-US">英文</option>
                            <option value="both">中英都抓</option>
                        </select>
                    </div>

                    <!-- 關鍵字 -->
                    <div class="form-group">
                        <label for="keyword">關鍵字 <span class="required">*</span></label>
                        <input type="text" id="keyword" name="keyword"
                               placeholder="例如：AI 法規、人工智慧" required>
                    </div>

                    <!-- 抓取篇數 -->
                    <div class="form-group">
                        <label for="count">抓取篇數 (1-20)</label>
                        <input type="number" id="count" name="count"
                               min="1" max="20" value="5" required>
                    </div>

                    <!-- 日期模式 -->
                    <div class="form-group">
                        <label>日期模式</label>
                        <div class="radio-group">
                            <label class="radio-label">
                                <input type="radio" name="dateMode" value="today" checked>
                                <span>僅限當日 (Asia/Taipei)</span>
                            </label>
                            <label class="radio-label">
                                <input type="radio" name="dateMode" value="custom">
                                <span>自訂日期範圍</span>
                            </label>
                        </div>
                    </div>

                    <!-- 自訂日期範圍 -->
                    <div class="form-group date-range" id="dateRangeGroup" style="display: none;">
                        <div class="date-inputs">
                            <div class="date-input">
                                <label for="startDate">開始日期</label>
                                <input type="date" id="startDate" name="startDate">
                            </div>
                            <div class="date-input">
                                <label for="endDate">結束日期</label>
                                <input type="date" id="endDate" name="endDate">
                            </div>
                        </div>
                    </div>

                    <!-- 收件人 Email -->
                    <div class="form-group">
                        <label for="email">收件人 Email</label>
                        <input type="email" id="email" name="email"
                               value="shaoairai@gmail.com" required>
                    </div>

                    <!-- 送出按鈕 -->
                    <button type="submit" id="submitBtn" class="submit-btn">
                        <span class="btn-text">開始執行</span>
                        <span class="btn-loading" style="display: none;">
                            <span class="spinner"></span> 處理中...
                        </span>
                    </button>
                </form>
            </section>

            <!-- 執行狀態 -->
            <section class="status-section" id="statusSection" style="display: none;">
                <div class="status-card" id="statusCard">
                    <div class="status-icon" id="statusIcon">⏳</div>
                    <div class="status-message" id="statusMessage">正在處理中...</div>
                    <div class="status-details" id="statusDetails"></div>
                </div>
            </section>

            <!-- 結果顯示區 -->
            <section class="results-section" id="resultsSection" style="display: none;">
                <h2>📋 搜尋結果</h2>
                <div class="results-summary" id="resultsSummary"></div>
                <div class="articles-list" id="articlesList"></div>
            </section>
        </main>

        <footer>
            <p>© 2024 每日新聞摘要系統 | Powered by FastAPI</p>
        </footer>
    </div>

    <!-- 設定彈窗 -->
    <div class="modal-overlay" id="settingsModal" style="display: none;">
        <div class="modal">
            <div class="modal-header">
                <h2>⚙️ 系統設定</h2>
                <button type="button" class="modal-close" onclick="closeSettings()">✕</button>
            </div>
            <div class="modal-body">
                <p class="settings-note">設定會在頁面重新整理後生效，重啟容器後會重置。如需永久保存請更新 .env 檔案。</p>

                <div class="settings-section">
                    <h3>🔍 Google Custom Search API</h3>
                    <p class="settings-desc">用於更精準的新聞搜尋（每日免費 100 次）</p>
                    <div class="settings-group">
                        <label for="googleApiKey">API Key</label>
                        <input type="password" id="googleApiKey" placeholder="從 Google Cloud Console 取得">
                    </div>
                    <div class="settings-group">
                        <label for="googleSearchEngineId">Search Engine ID</label>
                        <input type="text" id="googleSearchEngineId" placeholder="從 Programmable Search Engine 取得">
                    </div>
                </div>

                <div class="settings-section">
                    <h3>📧 SMTP 郵件設定</h3>
                    <p class="settings-desc">用於發送新聞摘要郵件</p>
                    <div class="settings-group">
                        <label for="smtpHost">SMTP 主機</label>
                        <input type="text" id="smtpHost" placeholder="smtp.gmail.com">
                    </div>
                    <div class="settings-group">
                        <label for="smtpPort">SMTP 連接埠</label>
                        <input type="number" id="smtpPort" placeholder="587">
                    </div>
                    <div class="settings-group">
                        <label for="smtpUser">帳號 (Email)</label>
                        <input type="email" id="smtpUser" placeholder="your-email@gmail.com">
                    </div>
                    <div class="settings-group">
                        <label for="smtpPass">密碼 / App Password</label>
                        <input type="password" id="smtpPass" placeholder="Gmail 需使用應用程式密碼">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-secondary" onclick="closeSettings()">取消</button>
                <button type="button" class="btn-primary" onclick="saveSettings()">儲存設定</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
